% include("header")
<body>


    <div class="w-2/4 min-h-screen border-x border-gray-300 absolute top-0 sm:left-96 md:left-1/4 left-1/3 z-20
    ">

        <section id="profile-page" class="border-t border-slate-200 w-[90%]">
             <div class="w-full h-64 bg-gray-400">
                <div class=""> <img class="absolute top-48 p-4 flex-none h-40 w-40 rounded-full"
                        src="{{user['image']}}"
                        alt="photo"></div>
            </div>
            <div class="flex justify-end mt-2 px-4">
                <!-- TODO: update picture name is profile-img -->
                <form  onsubmit="return false">
                    <label>
                        <input id= "profile-img"
                        type="file" name="image" class="">
                      </label>
                        <button id ="{{user['name']}}" onclick = "uploadProfilePic(id)"class=" text-lg text-gray-600 font-medium bg-gray-300 hover:bg-gray-400 hover:text-white rounded-full w-32 p-1">Set
                            profile pic</button>

                </form>
            </div>
            <div id="user-info" class="mt-6 px-4 py-2">
                <h4>@{{user["name"]}}</h4>
                <h5>{{user["full_name"]}}</h5>
                <div class="flex"> <i class="fas fa-calendar mt-1"></i>
                    <p class="pl-4">Joined:
                      <span class = "text-gray-600">{{user["joined"]}} </span> </p>
                </div>

            </div>
            <div id="links" class ="flex justify-between font-bold p-2 border-b-2 border-gray-200">
                <p class="cursor-pointer border-b-4 hover:border-blue-500 px-2">Tweets</p>
                <p class="cursor-pointer hover:border-b-4 border-blue-500 px-2">Tweets&replies</p>
                <p class="cursor-pointer hover:border-b-4 border-blue-500 px-2">Media</p>
                <p class="cursor-pointer hover:border-b-4 border-blue-500 px-2">Likes</p>

            </div>
            <p class = "font-extrabold text-2xl ml-2">Tweets</p>
            %for tweet in tweets:
<!-- tweets -->

<section id="{{tweet['tweet_id']}}" class="p-4 border-t border-slate-200">
  <div class="flex">

    <!-- <img class="flex-none w-12 h-12 rounded-full" src="" alt="photo"> -->

    <img class="flex-none w-12 h-12 rounded-full"
      src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" alt="photo">



    <div  class="w-full pl-4">
      <div class="flex cursor-pointer">
        <p class="ml-auto text-sm text-gray-500">{{tweet["tweet_created_at"]}}</p>
      </div>
    </a>
      <div id="tweet-text" class="pt-2">
        {{tweet["tweet_text"]}}
      </div>
      %if tweet['tweet_image'] !="":
      <img id="tweet-img" class="mt-2 w-full object-cover h-80" src="/img/{{tweet['tweet_image']}}">
      % end
      <div id="icons" class="flex gap-12 w-full mt-4 text-lg">
        <button id = "delete" onclick="deleteTweet(`{{tweet['tweet_id']}}`)"><i
            class="fa-solid fa-trash mr-auto cursor-pointer"></i> </button>

        <button onclick="showTweetToEdit(`{{tweet['tweet_id']}}`)">
          <i class="fa-solid fa-pen mr-auto cursor-pointer"></i>
        </button>
        <!-- TODO: like event and trigger -->
        <button><i class="fa-solid fa-heart cursor-pointer  ml-auto"></i></button>

      </div>
    </div>
  </div>
</section>

  %end
    </div>

    </section>

    </div>

<script>

// TODO: move to script in SPA upload profile img
function uploadProfilePic(id){

console.log("click",id)

}
//update tweet
async function uploadProfilePic(id) {
  const form = event.target.form
  console.log("form")
  //Connect to the api and delete it from the db
  const connection = await fetch(`/${id}`, {
    method: "PUT",
    body: new FormData(form)
  })
  console.log(connection)
  if (!connection.ok) {
    alert("Could not update")
    return
  }
  //Success
   let profilePic = await connection.json()
    console.log(profilePic)
  // let tweetSection = document.querySelector(`section[id='${tweet_id}']`)
  // console.log(tweetSection)
  // //if text is not changed leave it as is
  // if (tweetSection.querySelector("#tweet-text").textContent != null) {
  //   tweetSection.querySelector("#tweet-text").textContent = editedTweet.tweet_text
  // } else {
  //   tweetSection.querySelector("#tweet-text").textContent = tweetSection.querySelector("#tweet-text").textContent
  }

</script>
</body>